{
    "id": "org.eyecreate.qiflora",
    "runtime": "org.kde.Platform",
    "runtime-version": "5.12",
    "sdk": "org.kde.Sdk",
    "command": "qiflora",
    "tags": ["kde"],
    "finish-args": [
        "--share=ipc",
        "--allow=bluetooth",
        "--system-talk-name=org.bluez",
        "--share=network",
        "--socket=x11",
        "--socket=wayland",
        "--device=dri",
        "--filesystem=home",
        "--talk-name=org.freedesktop.Notifications"
    ],
    "separate-locales": false,

    "modules": [
        {
            "name": "udev",
            "rm-configure": true,
            "config-opts": [
                "--disable-hwdb",
                "--disable-logging",
                "--disable-introspection",
                "--disable-keymap",
                "--disable-mtd_probe",
                "--with-systemdsystemunitdir=/app/lib/systemd/"
            ],
            "cleanup": [
                "/include",
                "/etc",
                "/libexec",
                "/sbin",
                "/lib/pkgconfig",
                "/lib/systemd",
                "/man",
                "/share/aclocal",
                "/share/doc",
                "/share/gtk-doc",
                "/share/man",
                "/share/pkgconfig",
                "*.la",
                "*.a"
            ],
            "sources": [
                {
                "type": "archive",
                "url": "https://www.kernel.org/pub/linux/utils/kernel/hotplug/udev-175.tar.bz2",
                "sha256": "4c7937fe5a1521316ea571188745b9a00a9fdf314228cffc53a7ba9e5968b7ab"
                },
                {
                "type": "patch",
                "path": "sysmacros.patch"
                },
                {
                "type": "script",
                "dest-filename": "autogen.sh",
                "commands": [
                    "autoreconf -vfi"
                ]
                }
            ],
            "post-install": [
                "sed -i 's|${exec_prefix}|/app|g' /app/share/pkgconfig/udev.pc"
            ]
        },
        {
            "name": "ical",
            "cleanup": [
                "/lib/cmake"
            ],
            "buildsystem": "cmake-ninja",
            "config-opts": [
                "-DCMAKE_BUILD_TYPE=RelWithDebInfo",
                "-DCMAKE_INSTALL_LIBDIR=/app/lib",
                "-DBUILD_SHARED_LIBS=ON"
            ],
            "sources": [ { "type": "archive", "url": "https://github.com/libical/libical/archive/v3.0.5.tar.gz", "sha256": "483acbf7fee66ca071c2ff8183e46b6f2b3a89e1e866eadf4870eaaa281c8db1" } ]
        },
        {
            "name": "bluez",
            "config-opts": [
                "--disable-datafiles",
                "--disable-systemd",
                "--enable-library",
                "--prefix=/app",
                "--sysconfdir=/app/etc"
            ],
            "sources": [ { "type": "archive", "url": "https://mirrors.edge.kernel.org/pub/linux/bluetooth/bluez-5.50.tar.xz", "sha256": "5ffcaae18bbb6155f1591be8c24898dc12f062075a40b538b745bfd477481911"} ]
        },
        {
            "name": "qtconnectivity",
            "buildsystem": "simple",
            "cleanup-platform": [
                "/bin",
                "/mkspecs"
            ],
            "sources": [ { "type": "git", "url": "https://github.com/qt/qtconnectivity", "branch": "5.12.4", "commit": "f6be1f73a810514335ab3d27e1d05825a36b06af" } ],
            "build-commands": [
                "qmake",
                "make -j $FLATPAK_BUILDER_N_JOBS",
                "cp -r -n bin /app",
                "cp -r -n include /app",
                "cp -r -n lib /app",
                "mkdir -p /app/src/bluetooth",
                "cp -r src/bluetooth /app/src/"
            ]
        },
        {
            "name": "qiflora",
            "buildsystem": "cmake-ninja",
            "builddir": true,
            "sources": [ { "type": "git", "url": "https://git.eyecreate.org/eyecreate/qiflora.git", "tag": "v1.0", "commit": "bcdf831d0c64f84642f53a4f8376a26df412b819" } ]
        }
    ]
}
